<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MEXC Scalper • Advanced Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <link rel="stylesheet" href="/public/style.css">
</head>
<body>
<header>
  <h1>MEXC Scalper • Advanced Dashboard</h1>
  <span class="pill" id="drypill">DRY</span>
  <span class="pill" id="haltpill">LIVE</span>
  <span class="pill" id="masterpill">MASTER: LIVE</span>
  <a class="pill link" id="pnlcsv" target="_blank">pnl.csv</a>
  <a class="pill link" id="logscsv" target="_blank">logs.csv</a>
  <a class="pill link" id="config" target="_blank">config</a>
</header>

<div class="wrap">
  <div class="card"><h2>Equity Curve (realized PnL)</h2><canvas id="eq"></canvas></div>
  <div class="card">
    <h2>Performance</h2>
    <div class="grid" id="kpis"></div>
    <div class="smallgrid" style="margin-top:10px">
      <div class="streak">
        <div><b>Streaks</b></div>
        <div>Current Wins: <span id="cwin">—</span></div>
        <div>Current Losses: <span id="closs">—</span></div>
        <div>Max Wins: <span id="mwin">—</span></div>
        <div>Max Losses: <span id="mloss">—</span></div>
      </div>
      <div class="streak">
        <div><b>Drawdown</b></div>
        <div>Max DD (USDT): <span id="ddval">—</span></div>
        <div>Peak/Valley visible in chart</div>
      </div>
    </div>
  </div>

  <div class="card"><h2>Drawdown Curve (USDT from peak)</h2><canvas id="dd"></canvas></div>
  <div class="card"><h2>Win/Loss Distribution (Realized USDT per trade)</h2><canvas id="hist"></canvas></div>

  <div class="card"><h2>Daily Summary (UTC @ reset)</h2>
    <table id="daily"><thead><tr>
      <th>Day@Hour</th><th>Trades</th><th>Wins</th><th>Losses</th>
      <th>Win%</th><th>PF</th><th>Gross P</th><th>Gross L</th><th>Net</th>
    </tr></thead><tbody></tbody></table>
  </div>

  <div class="card"><h2>Live Feed</h2><div class="logs" id="live"></div></div>

  <div class="card"><h2>Recent Trades</h2>
    <table id="trades">
      <thead><tr><th>Time (UTC)</th><th>Symbol</th><th>Side</th><th>Price</th><th>Size</th><th>Realized</th><th>Fee</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Admin (real). Requires DASHBOARD_TOKEN set on server -->
  <div class="card">
    <h2>Admin Controls (real)</h2>
    <div class="grid" style="grid-template-columns: repeat(4,1fr); gap:10px;">
      <div class="kpi">
        <div><b>Dashboard Token</b></div>
        <input id="admintok" type="password" placeholder="Paste DASHBOARD_TOKEN" style="width:100%;margin-top:6px;">
        <button id="saveTok" style="margin-top:6px;width:100%;">Save</button>
      </div>
      <div class="kpi">
        <div><b>Symbol</b></div>
        <input id="sym" value="BTC/USDT:USDT" style="width:100%;margin-top:6px;">
      </div>
      <div class="kpi">
        <div><b>Cooldown (s)</b></div>
        <input id="cdsecs" type="number" value="120" min="1" style="width:100%;margin-top:6px;">
      </div>
      <div class="kpi">
        <div><b>Status</b></div>
        <div id="simmsg" style="margin-top:6px; color:#8fa1c7;">—</div>
      </div>
    </div>

    <div class="row" style="gap:10px; margin-top:12px;">
      <button id="btnCooldown">Cooldown</button>
      <button id="btnHalt" style="background:#3b0e0e;border:1px solid #5a1a1a;">Halt</button>
      <button id="btnUnhalt" style="background:#0e2f10;border:1px solid #1d5a23;">Unhalt</button>
      <button id="btnHaltAll" style="background:#3b0e0e;border:1px solid #5a1a1a; margin-left:10px;">Master Halt</button>
      <button id="btnUnhaltAll" style="background:#0e2f10;border:1px solid #1d5a23;">Master Unhalt</button>
    </div>
  </div>
</div>

<script src="/public/app.js"></script>
</body>
</html>
